(function($){var e=38,t=40,n=39,r=37,a=13,i=27;var l="<ul class='dropdown-menu af-dropdown-menu'></ul>";var s=function(e){return"<li><a href='#'>"+e+"</a></li>"};var o=function(e,t){e.empty();$.each(t,function(t,n){e.append($(s(n)))})};var f=function(e,t){var n=[];if(e.length===0){return t}var r=new RegExp(".*"+e+".*","i");$.each(t,function(e,t){if(r.test(t)){n.push(t)}});return n};var c=function(e,t,n){var r=f(e,t);o(n,r)};var u=[];var v=function(n,r){var s=this;n.addClass("af-input");var o=$(l).insertAfter(n);var f=r.data||[];this.el=n.get(0);this.$el=n;this.options=r;this.setData=function(e){f=e;r.data=f;c(n.val(),f,o);return s.$el};this.getData=function(){return f};var u=function(){var e=o.find("li.selected").text();if(r.preAdd&&r.preAdd.apply(s,[e,n])===false){return}n.val(e);d();if(r.postAdd)r.postAdd(e,n)};var v=function(r){var l=r.which;if($.inArray(l,[e,t,a,i])<0){c(n.val(),f,o);h();return}console.log("keyup");var s=o.children("li");if(s.length===0){return}var v=s.filter(".selected");if(v.length===0){if(l==e){v=s.eq(0)}else if(l==t){v=s.eq(s.length-1)}}var p=s.index(v);switch(l){case e:p--;break;case t:p++;break;case a:if(v.length===0){return}u();if(v.next().length>0){v.next().addClass("selected")}else{v.prev().addClass("selected")}v.remove();return;case i:d();return}if(p<0){p+=s.length}else if(p>=s.length){p%=s.length}v.removeClass("selected");s.eq(p).addClass("selected")};var h=function(){c(n.val(),f,o);o.show()};var d=function(){o.hide()};var p=function(e){var t=e.target;if(t!==o.get(0)&&t!==n.get(0)){d()}};var g=function(){n.on("focus",h).on("keyup",v);$("html").on("click",p);o.on("click","li",function(e){e.preventDefault();$(this).addClass("selected").siblings(".selected").removeClass("selected");u();d()})};var y=function(){};g();this.collection.push(this)};var h=v.prototype.collection=[];var d=function(e){var t=null;$.each(h,function(){if(this.el===e){t=this}});return t};var p={data:{getter:"getData",setter:"setData"}};var g=function(){var e=$(this);if(e.length===0){return e}var t=Array.prototype.slice.apply(arguments,[]);var n;var r=d(e.get(0));if(t.length===0){n=t[0]={}}else if(t.length===1&&typeof t[0]==="object"){n=t[0]}else if(t.length>1&&t[0]==="options"){if(!r){throw Error("Trying to set options before even initialization")}var a=p[t[1]];if(!a){throw Error("Invalid Option")}if(t.length===2){return r[a.getter]()}else if(t.length===3){r[a.setter](t[2]);return r.$el}}else{throw Error("Invalid Arguments")}return $.each(e,function(){u.push(new v($(this),n))})};$.fn.autoFill=g})(jQuery);