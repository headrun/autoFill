(function($){"use strict";var e=38,t=40,n=39,r=37,i=13,a=27;var l="<ul class='dropdown-menu af-dropdown-menu'></ul>";function s(e){return"<li><a href='#'>"+e+"</a></li>"}function o(e,t){e.empty();$.each(t,function(t,n){e.append($(s(n)))})}function f(e,t){var n=[];if(e.length===0){return t}var r=new RegExp(".*"+e+".*","i");$.each(t,function(e,t){if(r.test(t)){n.push(t)}});return n}function u(e,t,n){var r=f(e,t);o(n,r)}var c=[];function h(n,r){n.addClass("af-input");var s=this;var o=$(l).insertAfter(n);var f=r.data||[];this.el=n.get(0);this.$el=n;this.options=r;this.setData=function(e){f=e;r.data=f;u(n.val(),f,o);return s.$el};this.getData=function(){return f};function c(){var e=o.find("li.selected").text();if(r.preAdd&&r.preAdd.apply(s,[e,n])===false){return}n.val(e);v();if(r.postAdd){r.postAdd(e,n)}}function h(r){var l=r.which;if($.inArray(l,[e,t,i,a])<0){u(n.val(),f,o);d();return}var s=o.children("li");if(s.length===0){return}var h=s.filter(".selected");if(h.length===0){if(l===e){h=s.eq(0)}else if(l===t){h=s.eq(s.length-1)}}var p=s.index(h);switch(l){case e:p--;break;case t:p++;break;case i:if(h.length===0){return}c();if(h.next().length>0){h.next().addClass("selected")}else{h.prev().addClass("selected")}h.remove();return;case a:v();return}if(p<0){p+=s.length}else if(p>=s.length){p%=s.length}h.removeClass("selected");s.eq(p).addClass("selected")}var d=this.showAutoFill=function(){u(n.val(),f,o);o.show()};var v=this.hideAutoFill=function(){o.hide()};function p(e){var t=e.target;if(t!==o.get(0)&&t!==n.get(0)){v()}}var g=function(){n.on("focus",d).on("keyup",h);$("html").on("click",p);o.on("click","li",function(e){e.preventDefault();$(this).addClass("selected").siblings(".selected").removeClass("selected");c();v()})};function w(){}g();this.collection.push(this)}var d=h.prototype.collection=[];function v(e){var t=null;$.each(d,function(){if(this.el===e){t=this}});return t}var p={data:{getter:"getData",setter:"setData"}};var g=function(){var e=$(this);if(e.length===0){return e}var t=Array.prototype.slice.apply(arguments,[]);var n;var r=v(e.get(0));if(t.length===0){n=t[0]={}}else if(t.length===1&&typeof t[0]==="object"){n=t[0]}else if(t.length>1&&t[0]==="options"){if(!r){throw Error("Trying to set options before even initialization")}var i=p[t[1]];if(!i){throw Error("Invalid Option")}if(t.length===2){return r[i.getter]()}else if(t.length===3){r[i.setter](t[2]);return r.$el}}else{throw Error("Invalid Arguments")}return $.each(e,function(){c.push(new h($(this),n))})};$.fn.autoFill=g})(jQuery);